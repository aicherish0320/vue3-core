{"version":3,"file":"vue.js","sources":["../src/reactivity/computed.ts","../src/reactivity/effect.ts","../src/shared/index.ts","../src/reactivity/baseHandlers.ts","../src/reactivity/reactive.ts","../src/reactivity/ref.ts"],"sourcesContent":["export function computed() {}\r\n","export function effect() {}\r\n","export const isObject = (val) => typeof val === 'object' && val !== null\r\nexport const isSymbol = (val) => typeof val === 'symbol'\r\nexport const isArray = (val) => Array.isArray(val)\r\nexport const isInteger = (key) => parseInt(key, 10) + '' === key\r\nconst hasOwnProperty = Object.prototype.hasOwnProperty\r\nexport const hasOwn = (val, key) => hasOwnProperty.call(val, key)\r\nexport const hasChanged = (value, oldValue) => value !== oldValue\r\n","import {\r\n  isObject,\r\n  isArray,\r\n  isInteger,\r\n  hasOwn,\r\n  hasChanged\r\n} from './../shared/index'\r\nimport { reactive } from './reactive'\r\nfunction createGetter() {\r\n  return function get(target, key, receiver) {\r\n    const ret = Reflect.get(target, key, receiver)\r\n\r\n    if (isObject(ret)) {\r\n      return reactive(ret)\r\n    }\r\n\r\n    return ret\r\n  }\r\n}\r\nfunction createSetter() {\r\n  return function set(target, key, value, receiver) {\r\n    const oldValue = target[key]\r\n    // 数组新增、对象新增\r\n    const hadKey =\r\n      isArray(target) && isInteger(key)\r\n        ? Number(key) < target.length\r\n        : hasOwn(target, key)\r\n\r\n    const ret = Reflect.set(target, key, value, receiver)\r\n\r\n    if (!hadKey) {\r\n      console.log('新增')\r\n    } else if (hasChanged(value, oldValue)) {\r\n      console.log('修改属性')\r\n    }\r\n\r\n    return ret\r\n  }\r\n}\r\n\r\nconst get = createGetter()\r\nconst set = createSetter()\r\n\r\nexport const mutableHandlers = {\r\n  get,\r\n  set\r\n}\r\n","import { mutableHandlers } from './baseHandlers'\r\nimport { isObject } from './../shared/index'\r\n\r\nexport function reactive(target: object) {\r\n  // 核心的操作就是当读取数据时进行依赖收集，修改数据的时候让effect重新执行\r\n  return createReactiveObject(target, mutableHandlers)\r\n}\r\n\r\nconst proxyMap = new WeakMap()\r\nfunction createReactiveObject(target: object, baseHandlers) {\r\n  if (!isObject(target)) return target\r\n\r\n  const existingProxy = proxyMap.get(target)\r\n  if (existingProxy) {\r\n    return existingProxy\r\n  }\r\n\r\n  const proxy = new Proxy(target, baseHandlers)\r\n  proxyMap.set(target, proxy)\r\n\r\n  return proxy\r\n}\r\n","export function ref() {}\r\n"],"names":[],"mappings":"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"}